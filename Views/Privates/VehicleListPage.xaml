<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:controle_ja_mobile.ViewModels"
             xmlns:models="clr-namespace:controle_ja_mobile.Models"
             x:Class="controle_ja_mobile.Views.Privates.VehicleListPage"
             x:DataType="vm:VehiclesViewModel"
             Title="Minha Garagem"
             BackgroundColor="{StaticResource PageBackgroundColorDark}">

    <Grid RowDefinitions="*, Auto">

        <RefreshView Grid.Row="0" IsRefreshing="{Binding IsRefreshing}" Command="{Binding LoadVehiclesCommand}" RefreshColor="{StaticResource Primary}">
            <CollectionView ItemsSource="{Binding Vehicles}" Margin="20">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="15"/>
                </CollectionView.ItemsLayout>

                <CollectionView.EmptyView>
                    <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="10" Opacity="0.5">
                        <Label Text="Nenhum veÃ­culo cadastrado" TextColor="White"/>
                    </VerticalStackLayout>
                </CollectionView.EmptyView>

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Vehicle">
                        <Border StrokeShape="RoundRectangle 20" StrokeThickness="0" BackgroundColor="{StaticResource CardBackgroundDark}" HeightRequest="130">
                            <Grid ColumnDefinitions="10, *, Auto" RowDefinitions="*, Auto">
                                <BoxView Grid.RowSpan="2" Color="{StaticResource Primary}" WidthRequest="5"/>

                                <VerticalStackLayout Grid.Column="1" Padding="15,15,0,0" Spacing="2">
                                    <Label Text="{Binding Name}" TextColor="{StaticResource Primary}" FontAttributes="Bold" FontSize="18"/>
                                    <Label Text="{Binding FullDescription}" TextColor="{StaticResource TextSecondaryDark}" FontSize="14"/>

                                    <Border Margin="0,10,0,0" HorizontalOptions="Start" BackgroundColor="#2D3A4F" StrokeThickness="0" Padding="10,5" StrokeShape="RoundRectangle 8">
                                        <Label Text="{Binding ConsumptionInfo}" TextColor="#E2E8F0" FontSize="11"/>
                                    </Border>
                                </VerticalStackLayout>

                                <VerticalStackLayout Grid.Column="2" Grid.Row="0" Padding="0,15,15,0" HorizontalOptions="End">
                                    <Label Text="KM Atual" TextColor="{StaticResource TextSecondaryDark}" FontSize="10" HorizontalOptions="End"/>
                                    <Label Text="{Binding FormattedOdometer}" TextColor="White" FontAttributes="Bold" FontSize="16" HorizontalOptions="End"/>
                                </VerticalStackLayout>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </RefreshView>

        <Button Grid.Row="0"
                Text="+" 
                Command="{Binding GoToAddPageCommand}"
                BackgroundColor="{StaticResource Primary}"
                TextColor="Black"
                FontSize="24"
                CornerRadius="30"
                HeightRequest="60"
                WidthRequest="60"
                HorizontalOptions="End"
                VerticalOptions="End"
                Margin="25"
                Shadow="{Shadow Radius=10, Offset='0,5', Brush='#00E676'}"/>

        <ActivityIndicator Grid.RowSpan="2" IsRunning="{Binding IsLoading}" IsVisible="{Binding IsLoading}" 
                           Color="{StaticResource Primary}" VerticalOptions="Center" HorizontalOptions="Center"/>
    </Grid>
</ContentPage>